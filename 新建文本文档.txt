package ga;

import com.alibaba.fastjson.JSONObject;
import com.hikvision.artemis.sdk.ArtemisHttpUtil;
import com.hikvision.artemis.sdk.config.ArtemisConfig;
import java.util.HashMap;
import java.util.Map;

/**
 * @author Create by zqz since 2026/1/15 17:51
 */
public class GetCameraPreviewURL  {

    public static String GetCameraPreviewURL() {
        ArtemisConfig config = new ArtemisConfig();
        /**
         * STEP1：设置平台参数，根据实际情况,设置host appkey appsecret 三个参数.
         */
        config.setHost("10.78.170.139"); // 代理API网关nginx服务器ip端口
        config.setAppKey("23278727");  // 秘钥appkey
        config.setAppSecret("0xpDNNwO4IjWvipbmyc6");// 秘钥appSecret

//        config.setHost("10.31.196.252"); // 代理API网关nginx服务器ip端口
//        config.setAppKey("admin");  // 秘钥appkey
//        config.setAppSecret("GYssYGYB3!!245");// 秘钥appSecret

        /**
         * STEP2：设置OpenAPI接口的上下文
         */
        final String ARTEMIS_PATH = "/artemis";

        /**
         * STEP3：设置接口的URI地址
         */
//        final String previewURLsApi = ARTEMIS_PATH +"/api/resource/v2/camera/search";  //根据条件查询目录下有权限的监控点列表
//        final String previewURLsApi = ARTEMIS_PATH +"/api/resource/v1/cameras";  //获取监控点列表接口可用来全量同步监控点信息，返回结果分页展示。
//        final String previewURLsApi = ARTEMIS_PATH +"/api/video/v2/cameras/playbackURLs";
        final String previewURLsApi = ARTEMIS_PATH +"/api/video/v2/cameras/previewURLs";
        Map<String, String> path = new HashMap<String, String>(2) {
            {
                put("https://", previewURLsApi);//根据现场环境部署确认是http还是https
            }
        };

        /**
         * STEP4：设置参数提交方式
         */
        String contentType = "application/json";

        /**
         * STEP5：组装请求参数
         */
        JSONObject jsonBody = new JSONObject();
//        jsonBody.put("pageNo", "1");
//        jsonBody.put("pageSize", "100");
//        jsonBody.put("name", "海洋石油");
        jsonBody.put("cameraIndexCode", "9d41b7089f004d0a933a104b687175e3");
        jsonBody.put("streamType", 1);
//        jsonBody.put("protocol", "httpflv");
//        jsonBody.put("protocol", "hls");
        jsonBody.put("protocol", "hik");
//        jsonBody.put("expand", "transcode=1&resolution=720P&bitrate=256&framerate=24&videotype=h265&systemformat=rtp&audiotype=G711U&samples=8000&audiobitrate=64000&bitspersample=16");
        String body = jsonBody.toJSONString();

        /**
         * STEP6：调用接口
         */
        String result = null;// post请求application/json类型参数
        try {
            result = ArtemisHttpUtil.doPostStringArtemis(config,path, body, null, null, contentType, null);
        } catch (Exception e) {
            throw new RuntimeException(e);
        }
        return result;
    }


    public static void main(String[] args) {
        String result = GetCameraPreviewURL();
        System.out.println("result结果: " + result);
    }
}

